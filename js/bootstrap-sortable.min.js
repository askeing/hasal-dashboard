!function(a,b){"use strict";function c(){return b}"function"==typeof define&&define.amd?define("tinysort",c):a.tinysort=b}(this,function(){"use strict";function a(a,f){function j(){0===arguments.length?s({}):d(arguments,function(a){s(c(a)?{selector:a}:a)}),p=D.length}function s(a){var b=!!a.selector,c=b&&":"===a.selector[0],d=e(a||{},r);D.push(e({hasSelector:b,hasAttr:!(d.attr===i||""===d.attr),hasData:d.data!==i,hasFilter:c,sortReturnNumber:"asc"===d.order?1:-1},d))}function t(){d(a,function(a,b){y?y!==a.parentNode&&(E=!1):y=a.parentNode;var c=D[0],d=c.hasFilter,e=c.selector,f=!e||d&&a.matchesSelector(e)||e&&a.querySelector(e),g=f?B:C,h={elm:a,pos:b,posn:g.length};A.push(h),g.push(h)}),x=B.slice(0)}function u(){B.sort(v)}function v(a,e){var f=0;for(0!==q&&(q=0);0===f&&p>q;){var i=D[q],j=i.ignoreDashes?n:m;if(d(o,function(a){var b=a.prepare;b&&b(i)}),i.sortFunction)f=i.sortFunction(a,e);else if("rand"==i.order)f=Math.random()<.5?1:-1;else{var k=h,r=b(a,i),s=b(e,i),t=""===r||r===g,u=""===s||s===g;if(r===s)f=0;else if(i.emptyEnd&&(t||u))f=t&&u?0:t?1:-1;else{if(!i.forceStrings){var v=c(r)?r&&r.match(j):h,w=c(s)?s&&s.match(j):h;if(v&&w){var x=r.substr(0,r.length-v[0].length),y=s.substr(0,s.length-w[0].length);x==y&&(k=!h,r=l(v[0]),s=l(w[0]))}}f=r===g||s===g?0:s>r?-1:r>s?1:0}}d(o,function(a){var b=a.sort;b&&(f=b(i,k,r,s,f))}),f*=i.sortReturnNumber,0===f&&q++}return 0===f&&(f=a.pos>e.pos?1:-1),f}function w(){var a=B.length===A.length;E&&a?F?B.forEach(function(a,b){a.elm.style.order=b}):(B.forEach(function(a){z.appendChild(a.elm)}),y.appendChild(z)):(B.forEach(function(a){var b=a.elm,c=k.createElement("div");a.ghost=c,b.parentNode.insertBefore(c,b)}),B.forEach(function(a,b){var c=x[b].ghost;c.parentNode.insertBefore(a.elm,c),c.parentNode.removeChild(c)}))}c(a)&&(a=k.querySelectorAll(a)),0===a.length&&console.warn("No elements to sort");var x,y,z=k.createDocumentFragment(),A=[],B=[],C=[],D=[],E=!0,F=a.length&&(f===g||f.useFlex!==!1)&&-1!==getComputedStyle(a[0].parentNode,null).display.indexOf("flex");return j.apply(i,Array.prototype.slice.call(arguments,1)),t(),u(),w(),B.map(function(a){return a.elm})}function b(a,b){var d,e=a.elm;return b.selector&&(b.hasFilter?e.matchesSelector(b.selector)||(e=i):e=e.querySelector(b.selector)),b.hasAttr?d=e.getAttribute(b.attr):b.useVal?d=e.value||e.getAttribute("value"):b.hasData?d=e.getAttribute("data-"+b.data):e&&(d=e.textContent),c(d)&&(b.cases||(d=d.toLowerCase()),d=d.replace(/\s+/g," ")),d}function c(a){return"string"==typeof a}function d(a,b){for(var c,d=a.length,e=d;e--;)c=d-e-1,b(a[c],c)}function e(a,b,c){for(var d in b)(c||a[d]===g)&&(a[d]=b[d]);return a}function f(a,b,c){o.push({prepare:a,sort:b,sortBy:c})}var g,h=!1,i=null,j=window,k=j.document,l=parseFloat,m=/(-?\d+\.?\d*)\s*$/g,n=/(\d+\.?\d*)\s*$/g,o=[],p=0,q=0,r={selector:i,order:"asc",attr:i,data:i,useVal:h,place:"start",returns:h,cases:h,forceStrings:h,ignoreDashes:h,sortFunction:i,useFlex:h,emptyEnd:h};return j.Element&&function(a){a.matchesSelector=a.matchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector||a.webkitMatchesSelector||function(a){for(var b=this,c=(b.parentNode||b.document).querySelectorAll(a),d=-1;c[++d]&&c[d]!=b;);return!!c[d]}}(Element.prototype),e(f,{loop:d}),e(a,{plugin:f,defaults:r})}()),function(a){function b(b){var c="undefined"!=typeof moment;g=b.sign?b.sign:"arrow","default"==b.customSort&&(b.customSort=e),h=b.customSort||h||e,i=b.emptyEnd,a("table.sortable").each(function(){var e=a(this),g=b.applyLast===!0;e.find("span.sign").remove(),e.find("thead [colspan]").each(function(){for(var b=parseFloat(a(this).attr("colspan")),c=1;c<b;c++)a(this).after('<th class="colspan-compensate">')}),e.find("thead [rowspan]").each(function(){for(var b=a(this),c=parseFloat(b.attr("rowspan")),d=1;d<c;d++){var e=b.parent("tr"),f=e.next("tr"),g=e.children().index(b);f.children().eq(g).before('<th class="rowspan-compensate">')}}),e.find("thead tr").each(function(b){a(this).find("th").each(function(c){var d=a(this);d.addClass("nosort").removeClass("up down"),d.attr("data-sortcolumn",c),d.attr("data-sortkey",c+"-"+b)})}),e.find("thead .rowspan-compensate, .colspan-compensate").remove(),e.find("th").each(function(){var b=a(this);if(void 0!==b.attr("data-dateformat")&&c){var d=parseFloat(b.attr("data-sortcolumn"));e.find("td:nth-child("+(d+1)+")").each(function(){var c=a(this);c.attr("data-value",moment(c.text(),b.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss"))})}else if(void 0!==b.attr("data-valueprovider")){var d=parseFloat(b.attr("data-sortcolumn"));e.find("td:nth-child("+(d+1)+")").each(function(){var c=a(this);c.attr("data-value",new RegExp(b.attr("data-valueprovider")).exec(c.text())[0])})}}),e.find("td").each(function(){var b=a(this);void 0!==b.attr("data-dateformat")&&c?b.attr("data-value",moment(b.text(),b.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss")):void 0!==b.attr("data-valueprovider")?b.attr("data-value",new RegExp(b.attr("data-valueprovider")).exec(b.text())[0]):void 0===b.attr("data-value")&&b.attr("data-value",b.text())});var h=d(e),i=h.bsSort;e.find('thead th[data-defaultsort!="disabled"]').each(function(b){var c=a(this),d=c.closest("table.sortable");c.data("sortTable",d);var e=c.attr("data-sortkey"),j=g?h.lastSort:-1;i[e]=g?i[e]:c.attr("data-defaultsort"),void 0!==i[e]&&g===(e===j)&&(i[e]="asc"===i[e]?"desc":"asc",f(c,d))}),e.trigger("sorted")})}function c(b){var c=a(b),d=c.data("sortTable")||c.closest("table.sortable");d.trigger("before-sort"),f(c,d),d.trigger("sorted")}function d(b){var c=b.data("bootstrap-sortable-context");return void 0===c&&(c={bsSort:[],lastSort:void 0},b.find('thead th[data-defaultsort!="disabled"]').each(function(b){var d=a(this),e=d.attr("data-sortkey");c.bsSort[e]=d.attr("data-defaultsort"),void 0!==c.bsSort[e]&&(c.lastSort=e)}),b.data("bootstrap-sortable-context",c)),c}function e(a,b){tinysort(a,b)}function f(b,c){var e=parseFloat(b.attr("data-sortcolumn")),j=d(c),k=j.bsSort,l=b.attr("colspan");if(l){var m=parseFloat(b.data("mainsort"))||0,n=parseFloat(b.data("sortkey").split("-").pop());if(c.find("thead tr").length-1>n)return void f(c.find('[data-sortkey="'+(e+m)+"-"+(n+1)+'"]'),c);e+=m}var o=b.attr("data-defaultsign")||g;if(c.find("th").each(function(){a(this).removeClass("up").removeClass("down").addClass("nosort")}),a.browser.mozilla){var p=c.find("div.mozilla");void 0!==p&&(p.find(".sign").remove(),p.parent().html(p.html())),b.wrapInner('<div class="mozilla"></div>'),b.children().eq(0).append('<span class="sign '+o+'"></span>')}else c.find("span.sign").remove(),b.append('<span class="sign '+o+'"></span>');var q=b.attr("data-sortkey"),r="desc"!==b.attr("data-firstsort")?"desc":"asc",s=k[q]||r;j.lastSort!==q&&void 0!==k[q]||(s="asc"===s?"desc":"asc"),k[q]=s,j.lastSort=q,"desc"===k[q]?(b.find("span.sign").addClass("up"),b.addClass("up").removeClass("down nosort")):b.addClass("down").removeClass("up nosort");var t=c.children("tbody").children("tr"),u=[];a(t.filter('[data-disablesort="true"]').get().reverse()).each(function(b,c){var d=a(c);u.push({index:t.index(d),row:d}),d.remove()});var v=t.not('[data-disablesort="true"]');if(0!=v.length){var w="asc"===k[q]&&i;h(v,{emptyEnd:w,selector:"td:nth-child("+(e+1)+")",order:k[q],data:"value"})}a(u.reverse()).each(function(a,b){0===b.index?c.children("tbody").prepend(b.row):c.children("tbody").children("tr").eq(b.index-1).after(b.row)}),c.find("td.sorted, th.sorted").removeClass("sorted"),v.find("td:eq("+e+")").addClass("sorted"),b.addClass("sorted")}var g,h,i,j=a(document);if(a.bootstrapSortable=function(a){void 0==a?b({}):a.constructor===Boolean?b({applyLast:a}):void 0!==a.sortingHeader?c(a.sortingHeader):b(a)},j.on("click",'table.sortable>thead th[data-defaultsort!="disabled"]',function(a){c(this)}),!a.browser){a.browser={chrome:!1,mozilla:!1,opera:!1,msie:!1,safari:!1};var k=navigator.userAgent;a.each(a.browser,function(b){a.browser[b]=!!new RegExp(b,"i").test(k),a.browser.mozilla&&"mozilla"===b&&(a.browser.mozilla=!!new RegExp("firefox","i").test(k)),a.browser.chrome&&"safari"===b&&(a.browser.safari=!1)})}a(a.bootstrapSortable)}(jQuery);